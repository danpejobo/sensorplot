name: CI - Test & Lint

# Definerer de "logiske punktene" hvor runneren skal starte
on:
  push:
    branches: ["main", "dev"]
  pull_request:
    branches: ["main", "dev"]

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      # 1. Henter koden din
      - name: Checkout code
        uses: actions/checkout@v4

      # 2. Setter opp Python (samme versjon som i pyproject.toml)
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.10"

      # 3. Installerer Poetry
      - name: Install Poetry
        run: |
          curl -sSL https://install.python-poetry.org | python3 -
          echo "$HOME/.local/bin" >> $GITHUB_PATH

      # 4. Installerer avhengigheter (cache gjør det raskere neste gang)
      - name: Install Dependencies
        run: poetry install
      
      # 5. Kjører testene dine (pytest er definert i pyproject.toml dev-dependencies)
      - name: Run Tests
        run: poetry run pytest